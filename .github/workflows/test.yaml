on: push
jobs:
  test:
    permissions:
      id-token: write
      contents: read
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: r-lib/actions/setup-r@v2
        with:
          extra-repositories: https://mrc-ide.r-universe.dev
      - uses: mrc-ide/orderly-action@main
        with:
          packit-url: https://packit.dide.ic.ac.uk/reside

      - run: |
          id <- orderly2::orderly_run("data")
          orderly2::orderly_location_push(id, "packit")

        shell: Rscript {0}
